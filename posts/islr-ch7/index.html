<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="[Rohit Goswami]">
<meta name="description" content="Chapter VII - Moving Beyond Linearity All the questions are as per the ISL seventh printing.
Common libsUsed&amp;lt;-c(&amp;#34;dplyr&amp;#34;,&amp;#34;ggplot2&amp;#34;,&amp;#34;tidyverse&amp;#34;, &amp;#34;ISLR&amp;#34;,&amp;#34;caret&amp;#34;,&amp;#34;MASS&amp;#34;, &amp;#34;gridExtra&amp;#34;, &amp;#34;pls&amp;#34;,&amp;#34;latex2exp&amp;#34;,&amp;#34;data.table&amp;#34;) invisible(lapply(libsUsed, library, character.only = TRUE))## ## Attaching package: &amp;#39;dplyr&amp;#39;## The following objects are masked from &amp;#39;package:stats&amp;#39;: ## ## filter, lag## The following objects are masked from &amp;#39;package:base&amp;#39;: ## ## intersect, setdiff, setequal, union## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──## ✔ tibble 2.1.3 ✔ purrr 0.3.3 ## ✔ tidyr 1." />
<meta name="keywords" content=", solutions, R, ISLR" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://rgoswami.me/posts/islr-ch7/" />


    <title>
        
            ISLR :: Moving Beyond Linearity :: Rohit Goswami  — A micellany of my thoughts
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://rgoswami.me/main.min.7bfbbe12786fa0ded4b4c0d792cbb36a5bd0bdb0b856dde57aa7b1f6fe0f2b87.css">




<meta itemprop="name" content="ISLR :: Moving Beyond Linearity">
<meta itemprop="description" content="Chapter VII - Moving Beyond Linearity All the questions are as per the ISL seventh printing.
Common libsUsed&lt;-c(&#34;dplyr&#34;,&#34;ggplot2&#34;,&#34;tidyverse&#34;, &#34;ISLR&#34;,&#34;caret&#34;,&#34;MASS&#34;, &#34;gridExtra&#34;, &#34;pls&#34;,&#34;latex2exp&#34;,&#34;data.table&#34;) invisible(lapply(libsUsed, library, character.only = TRUE))## ## Attaching package: &#39;dplyr&#39;## The following objects are masked from &#39;package:stats&#39;: ## ## filter, lag## The following objects are masked from &#39;package:base&#39;: ## ## intersect, setdiff, setequal, union## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──## ✔ tibble 2.1.3 ✔ purrr 0.3.3 ## ✔ tidyr 1.">


<meta itemprop="datePublished" content="2020-02-19T09:47:00&#43;00:00" />
<meta itemprop="dateModified" content="2020-02-19T09:47:00&#43;00:00" />
<meta itemprop="wordCount" content="5900">



<meta itemprop="keywords" content="solutions,R,ISLR," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://rgoswami.me"/>

<meta name="twitter:title" content="ISLR :: Moving Beyond Linearity"/>
<meta name="twitter:description" content="Chapter VII - Moving Beyond Linearity All the questions are as per the ISL seventh printing.
Common libsUsed&lt;-c(&#34;dplyr&#34;,&#34;ggplot2&#34;,&#34;tidyverse&#34;, &#34;ISLR&#34;,&#34;caret&#34;,&#34;MASS&#34;, &#34;gridExtra&#34;, &#34;pls&#34;,&#34;latex2exp&#34;,&#34;data.table&#34;) invisible(lapply(libsUsed, library, character.only = TRUE))## ## Attaching package: &#39;dplyr&#39;## The following objects are masked from &#39;package:stats&#39;: ## ## filter, lag## The following objects are masked from &#39;package:base&#39;: ## ## intersect, setdiff, setequal, union## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──## ✔ tibble 2.1.3 ✔ purrr 0.3.3 ## ✔ tidyr 1."/>



    <meta property="article:section" content="programming" />



    <meta property="article:published_time" content="2020-02-19 09:47:00 &#43;0000 UTC" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://rgoswami.me/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">/home/haozeke/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://rgoswami.me/about">About</a></li><li><a href="https://rgoswami.me/posts">Blog</a></li>
    </ul>
    <ul class="menu__inner"><li><a href="https://rgoswami.me/categories">Categories</a></li><li><a href="https://rgoswami.me/tags">Tags</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="32" height="32" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>

            
<script src="https://rgoswami.me/js/mathjax-config.js"></script>


<script type="text/javascript" id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-chtml.js"></script>

            <div class="content">
                
    <main class="post">

        <div class="post-info">
            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>28 minutes

            

            </p>
        </div>

        <article>
            <h1 class="post-title">
                <a href="https://rgoswami.me/posts/islr-ch7/">ISLR :: Moving Beyond Linearity</a>
            </h1>
                <hr />
                <aside id="toc">
                <div class="toc-title">Table of Contents</div>
                    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#chapter-vii---linear-model-selection-and-regularization">Chapter VII - Moving Beyond Linearity</a>
<ul>
<li><a href="#common">Common</a></li>
</ul></li>
<li><a href="#question-7.6---page-299">Question 7.6 - Page 299</a>
<ul>
<li><a href="#answer">Answer</a>
<ul>
<li><a href="#a-polynomial-regression">a) Polynomial regression</a></li>
<li><a href="#b-step-function-and-cross-validation">b) Step function and cross-validation</a></li>
</ul></li>
</ul></li>
<li><a href="#question-7.8---page-299">Question 7.8 - Page 299</a>
<ul>
<li><a href="#answer-1">Answer</a></li>
</ul></li>
<li><a href="#question-7.9---pages-299-300">Question 7.9 - Pages 299-300</a>
<ul>
<li><a href="#answer-2">Answer</a>
<ul>
<li><a href="#a-polynomial">a) Polynomial</a></li>
<li><a href="#b-multiple-polynomials">b) Multiple Polynomials</a></li>
<li><a href="#c-cross-validation-and-polynomial-selection">c) Cross validation and polynomial selection</a></li>
<li><a href="#d-regression-spline">d) Regression spline</a></li>
<li><a href="#e-range-of-regression-splines">e) Range of regression splines</a></li>
<li><a href="#f-cross-validation-for-best-spline">f) Cross validation for best spline</a></li>
</ul></li>
</ul></li>
<li><a href="#question-10---page-300">Question 10 - Page 300</a>
<ul>
<li><a href="#answer-3">Answer</a>
<ul>
<li><a href="#a-train-test">a) Train test</a></li>
<li><a href="#best-subset-selection">Best subset selection</a></li>
<li><a href="#b-gam">b) GAM</a></li>
<li><a href="#c-evaluate">c) Evaluate</a></li>
<li><a href="#d-summary">d) Summary</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
                </aside>
                <hr />

            

            <div class="post-content">
                

<h2 id="chapter-vii---linear-model-selection-and-regularization">Chapter VII - Moving Beyond Linearity</h2>

<p>All the questions are as per the
<a href="https://faculty.marshall.usc.edu/gareth-james/ISL/" target="_blank">ISL seventh
printing</a>.</p>

<h3 id="common">Common</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">libsUsed<span style="color:#f92672">&lt;-</span><span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;dplyr&#34;</span>,<span style="color:#e6db74">&#34;ggplot2&#34;</span>,<span style="color:#e6db74">&#34;tidyverse&#34;</span>,
            <span style="color:#e6db74">&#34;ISLR&#34;</span>,<span style="color:#e6db74">&#34;caret&#34;</span>,<span style="color:#e6db74">&#34;MASS&#34;</span>, <span style="color:#e6db74">&#34;gridExtra&#34;</span>,
            <span style="color:#e6db74">&#34;pls&#34;</span>,<span style="color:#e6db74">&#34;latex2exp&#34;</span>,<span style="color:#e6db74">&#34;data.table&#34;</span>)
<span style="color:#a6e22e">invisible</span>(<span style="color:#a6e22e">lapply</span>(libsUsed, library, character.only <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>))</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##
## Attaching package: &#39;dplyr&#39;</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## The following objects are masked from &#39;package:stats&#39;:
##
##     filter, lag</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## The following objects are masked from &#39;package:base&#39;:
##
##     intersect, setdiff, setequal, union</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## ✔ tibble  2.1.3     ✔ purrr   0.3.3
## ✔ tidyr   1.0.0     ✔ stringr 1.4.0
## ✔ readr   1.3.1     ✔ forcats 0.4.0</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Loading required package: lattice</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##
## Attaching package: &#39;caret&#39;</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## The following object is masked from &#39;package:purrr&#39;:
##
##     lift</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##
## Attaching package: &#39;MASS&#39;</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## The following object is masked from &#39;package:dplyr&#39;:
##
##     select</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##
## Attaching package: &#39;gridExtra&#39;</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## The following object is masked from &#39;package:dplyr&#39;:
##
##     combine</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##
## Attaching package: &#39;pls&#39;</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## The following object is masked from &#39;package:caret&#39;:
##
##     R2</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## The following object is masked from &#39;package:stats&#39;:
##
##     loadings</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##
## Attaching package: &#39;data.table&#39;</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## The following object is masked from &#39;package:purrr&#39;:
##
##     transpose</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## The following objects are masked from &#39;package:dplyr&#39;:
##
##     between, first, last</code></pre></div>
<h2 id="question-7.6---page-299">Question 7.6 - Page 299</h2>

<p>In this exercise, you will further analyze the <code>Wage</code> data set
considered throughout this chapter.</p>

<p><strong>(a)</strong> Perform polynomial regression to predict <code>wage</code> using <code>age</code>. Use
cross-validation to select the optimal degree <em>d</em> for the polynomial.
What degree was chosen, and how does this compare to the results of
hypothesis testing using ANOVA? Make a plot of the resulting polynomial
fit to the data.</p>

<p><strong>(b)</strong> Fit a step function to predict <code>wage</code> using <code>age</code>, and perform
cross-validation to choose the optimal number of cuts. Make a plot of
the fit obtained. In this exercise, we will generate simulated data, and
will then use this data to perform best subset selection.</p>

<h3 id="answer">Answer</h3>

<p>Lets get the data.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">set.seed</span>(<span style="color:#ae81ff">1984</span>)
wageDat<span style="color:#f92672">&lt;-</span>ISLR<span style="color:#f92672">::</span>Wage
wageDat <span style="color:#f92672">%&gt;%</span> str <span style="color:#f92672">%&gt;%</span> print</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## &#39;data.frame&#39;:    3000 obs. of  11 variables:
##  $ year      : int  2006 2004 2003 2003 2005 2008 2009 2008 2006 2004 ...
##  $ age       : int  18 24 45 43 50 54 44 30 41 52 ...
##  $ maritl    : Factor w/ 5 levels &#34;1. Never Married&#34;,..: 1 1 2 2 4 2 2 1 1 2 ...
##  $ race      : Factor w/ 4 levels &#34;1. White&#34;,&#34;2. Black&#34;,..: 1 1 1 3 1 1 4 3 2 1 ...
##  $ education : Factor w/ 5 levels &#34;1. &lt; HS Grad&#34;,..: 1 4 3 4 2 4 3 3 3 2 ...
##  $ region    : Factor w/ 9 levels &#34;1. New England&#34;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ jobclass  : Factor w/ 2 levels &#34;1. Industrial&#34;,..: 1 2 1 2 2 2 1 2 2 2 ...
##  $ health    : Factor w/ 2 levels &#34;1. &lt;=Good&#34;,&#34;2. &gt;=Very Good&#34;: 1 2 1 2 1 2 2 1 2 2 ...
##  $ health_ins: Factor w/ 2 levels &#34;1. Yes&#34;,&#34;2. No&#34;: 2 2 1 1 1 1 1 1 1 1 ...
##  $ logwage   : num  4.32 4.26 4.88 5.04 4.32 ...
##  $ wage      : num  75 70.5 131 154.7 75 ...
## NULL</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">wageDat <span style="color:#f92672">%&gt;%</span> summary <span style="color:#f92672">%&gt;%</span> print</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##       year           age                     maritl           race
##  Min.   :2003   Min.   :18.00   1. Never Married: 648   1. White:2480
##  1st Qu.:2004   1st Qu.:33.75   2. Married      :2074   2. Black: 293
##  Median :2006   Median :42.00   3. Widowed      :  19   3. Asian: 190
##  Mean   :2006   Mean   :42.41   4. Divorced     : 204   4. Other:  37
##  3rd Qu.:2008   3rd Qu.:51.00   5. Separated    :  55
##  Max.   :2009   Max.   :80.00
##
##               education                     region               jobclass
##  1. &lt; HS Grad      :268   2. Middle Atlantic   :3000   1. Industrial :1544
##  2. HS Grad        :971   1. New England       :   0   2. Information:1456
##  3. Some College   :650   3. East North Central:   0
##  4. College Grad   :685   4. West North Central:   0
##  5. Advanced Degree:426   5. South Atlantic    :   0
##                           6. East South Central:   0
##                           (Other)              :   0
##             health      health_ins      logwage           wage
##  1. &lt;=Good     : 858   1. Yes:2083   Min.   :3.000   Min.   : 20.09
##  2. &gt;=Very Good:2142   2. No : 917   1st Qu.:4.447   1st Qu.: 85.38
##                                      Median :4.653   Median :104.92
##                                      Mean   :4.654   Mean   :111.70
##                                      3rd Qu.:4.857   3rd Qu.:128.68
##                                      Max.   :5.763   Max.   :318.34
##</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">wageDat <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">sapply</span>(unique) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">sapply</span>(length) <span style="color:#f92672">%&gt;%</span> print</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##       year        age     maritl       race  education     region   jobclass
##          7         61          5          4          5          1          2
##     health health_ins    logwage       wage
##          2          2        508        508</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">library</span>(boot)</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##
## Attaching package: &#39;boot&#39;</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## The following object is masked from &#39;package:lattice&#39;:
##
##     melanoma</code></pre></div>
<h4 id="a-polynomial-regression">a) Polynomial regression</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">all.deltas <span style="color:#f92672">=</span> <span style="color:#a6e22e">rep</span>(<span style="color:#66d9ef">NA</span>, <span style="color:#ae81ff">10</span>)
<span style="color:#a6e22e">for </span>(i in <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>) {
  glm.fit <span style="color:#f92672">=</span> <span style="color:#a6e22e">glm</span>(wage<span style="color:#f92672">~</span><span style="color:#a6e22e">poly</span>(age, i), data<span style="color:#f92672">=</span>Wage)
  all.deltas[i] <span style="color:#f92672">=</span> <span style="color:#a6e22e">cv.glm</span>(Wage, glm.fit, K<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)<span style="color:#f92672">$</span>delta[2]
}
<span style="color:#a6e22e">plot</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>, all.deltas, xlab<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Degree&#34;</span>, ylab<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;CV error&#34;</span>, type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;l&#34;</span>, pch<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>, lwd<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, ylim<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1590</span>, <span style="color:#ae81ff">1700</span>))
min.point <span style="color:#f92672">=</span> <span style="color:#a6e22e">min</span>(all.deltas)
sd.points <span style="color:#f92672">=</span> <span style="color:#a6e22e">sd</span>(all.deltas)
<span style="color:#a6e22e">abline</span>(h<span style="color:#f92672">=</span>min.point <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.2</span> <span style="color:#f92672">*</span> sd.points, col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;red&#34;</span>, lty<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dashed&#34;</span>)
<span style="color:#a6e22e">abline</span>(h<span style="color:#f92672">=</span>min.point <span style="color:#f92672">-</span> <span style="color:#ae81ff">0.2</span> <span style="color:#f92672">*</span> sd.points, col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;red&#34;</span>, lty<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dashed&#34;</span>)
<span style="color:#a6e22e">legend</span>(<span style="color:#e6db74">&#34;topright&#34;</span>, <span style="color:#e6db74">&#34;0.2-standard deviation lines&#34;</span>, lty<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dashed&#34;</span>, col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;red&#34;</span>)</code></pre></div>

    <figure class="left" >
        <img src="https://rgoswami.me/islr/sol5/unnamed-chunk-4-1.png"   />

        
    </figure>


<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#75715e"># ANOVA</span>
fits<span style="color:#f92672">=</span><span style="color:#a6e22e">list</span>()
<span style="color:#a6e22e">for </span>(i in <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>) {
  fits[[i]]<span style="color:#f92672">=</span><span style="color:#a6e22e">glm</span>(wage<span style="color:#f92672">~</span><span style="color:#a6e22e">poly</span>(age,i),data<span style="color:#f92672">=</span>wageDat)
}
<span style="color:#a6e22e">anova</span>(fits[[1]],fits[[2]],fits[[3]],fits[[4]],fits[[5]],
  fits[[6]],fits[[7]],fits[[8]],fits[[9]],fits[[10]])</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Analysis of Deviance Table
##
## Model  1: wage ~ poly(age, i)
## Model  2: wage ~ poly(age, i)
## Model  3: wage ~ poly(age, i)
## Model  4: wage ~ poly(age, i)
## Model  5: wage ~ poly(age, i)
## Model  6: wage ~ poly(age, i)
## Model  7: wage ~ poly(age, i)
## Model  8: wage ~ poly(age, i)
## Model  9: wage ~ poly(age, i)
## Model 10: wage ~ poly(age, i)
##    Resid. Df Resid. Dev Df Deviance
## 1       2998    5022216
## 2       2997    4793430  1   228786
## 3       2996    4777674  1    15756
## 4       2995    4771604  1     6070
## 5       2994    4770322  1     1283
## 6       2993    4766389  1     3932
## 7       2992    4763834  1     2555
## 8       2991    4763707  1      127
## 9       2990    4756703  1     7004
## 10      2989    4756701  1        3</code></pre></div>
<ul>
<li>The 4th degree looks the best at the moment</li>
</ul>

<!--listend-->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#75715e"># 3rd or 4th degrees look best based on ANOVA test</span>
<span style="color:#75715e"># let&#39;s go with 4th degree fit</span>
<span style="color:#a6e22e">plot</span>(wage<span style="color:#f92672">~</span>age, data<span style="color:#f92672">=</span>wageDat, col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;darkgrey&#34;</span>)
agelims <span style="color:#f92672">=</span> <span style="color:#a6e22e">range</span>(wageDat<span style="color:#f92672">$</span>age)
age.grid <span style="color:#f92672">=</span> <span style="color:#a6e22e">seq</span>(from<span style="color:#f92672">=</span>agelims[1], to<span style="color:#f92672">=</span>agelims[2])
lm.fit <span style="color:#f92672">=</span> <span style="color:#a6e22e">lm</span>(wage<span style="color:#f92672">~</span><span style="color:#a6e22e">poly</span>(age, <span style="color:#ae81ff">4</span>), data<span style="color:#f92672">=</span>wageDat)
lm.pred <span style="color:#f92672">=</span> <span style="color:#a6e22e">predict</span>(lm.fit, <span style="color:#a6e22e">data.frame</span>(age<span style="color:#f92672">=</span>age.grid))
<span style="color:#a6e22e">lines</span>(age.grid, lm.pred, col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;blue&#34;</span>, lwd<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)</code></pre></div>

    <figure class="left" >
        <img src="https://rgoswami.me/islr/sol5/unnamed-chunk-6-1.png"   />

        
    </figure>



<h4 id="b-step-function-and-cross-validation">b) Step function and cross-validation</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#75715e"># cross-validation</span>
cv.error <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rep</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">9</span>)
<span style="color:#a6e22e">for </span>(i in <span style="color:#ae81ff">2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>) {
  wageDat<span style="color:#f92672">$</span>age.cut <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cut</span>(wageDat<span style="color:#f92672">$</span>age,i)
  glm.fit <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">glm</span>(wage<span style="color:#f92672">~</span>age.cut, data<span style="color:#f92672">=</span>wageDat)
  cv.error[i<span style="color:#ae81ff">-1</span>] <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cv.glm</span>(wageDat, glm.fit, K<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)<span style="color:#f92672">$</span>delta[1]  <span style="color:#75715e"># [1]:std, [2]:bias-corrected</span>
}
cv.error</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## [1] 1732.337 1682.978 1636.736 1635.600 1624.174 1610.688 1604.081 1612.005
## [9] 1607.022</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">cv.error</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## [1] 1732.337 1682.978 1636.736 1635.600 1624.174 1610.688 1604.081 1612.005
## [9] 1607.022</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">plot</span>(<span style="color:#ae81ff">2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>, cv.error, type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>)</code></pre></div>

    <figure class="left" >
        <img src="https://rgoswami.me/islr/sol5/unnamed-chunk-7-1.png"   />

        
    </figure>


<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">cut.fit <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">glm</span>(wage<span style="color:#f92672">~</span><span style="color:#a6e22e">cut</span>(age,<span style="color:#ae81ff">8</span>), data<span style="color:#f92672">=</span>wageDat)
preds <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">predict</span>(cut.fit, newdata<span style="color:#f92672">=</span><span style="color:#a6e22e">list</span>(age<span style="color:#f92672">=</span>age.grid), se<span style="color:#f92672">=</span><span style="color:#66d9ef">TRUE</span>)
se.bands <span style="color:#f92672">&lt;-</span> preds<span style="color:#f92672">$</span>fit <span style="color:#f92672">+</span> <span style="color:#a6e22e">cbind</span>(<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>preds<span style="color:#f92672">$</span>se.fit, <span style="color:#ae81ff">-2</span><span style="color:#f92672">*</span>preds<span style="color:#f92672">$</span>se.fit)
<span style="color:#a6e22e">plot</span>(wageDat<span style="color:#f92672">$</span>age, wageDat<span style="color:#f92672">$</span>wage, xlim<span style="color:#f92672">=</span>agelims, cex<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>, col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;darkgrey&#34;</span>)
<span style="color:#a6e22e">title</span>(<span style="color:#e6db74">&#34;Fit with 8 Age Bands&#34;</span>)
<span style="color:#a6e22e">lines</span>(age.grid, preds<span style="color:#f92672">$</span>fit, lwd<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;blue&#34;</span>)
<span style="color:#a6e22e">matlines</span>(age.grid, se.bands, lwd<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;blue&#34;</span>, lty<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)</code></pre></div>

    <figure class="left" >
        <img src="https://rgoswami.me/islr/sol5/unnamed-chunk-8-1.png"   />

        
    </figure>



<h2 id="question-7.8---page-299">Question 7.8 - Page 299</h2>

<p>Fit some of the non-linear models investigated in this chapter to the
<code>Auto</code> data set. Is there evidence for non-linear relationships in this
data set? Create some informative plots to justify your answer.</p>

<h3 id="answer-1">Answer</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">autoDat<span style="color:#f92672">&lt;-</span>ISLR<span style="color:#f92672">::</span>Auto</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">autoDat <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">pivot_longer</span>(<span style="color:#f92672">-</span><span style="color:#a6e22e">c</span>(mpg,name),names_to<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Params&#34;</span>,values_to<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Value&#34;</span>) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span>mpg,y<span style="color:#f92672">=</span>Value)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span> Params, scales <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;free_y&#34;</span>)</code></pre></div>

    <figure class="left" >
        <img src="https://rgoswami.me/islr/sol5/unnamed-chunk-10-1.png"   />

        
    </figure>



<p>Very clearly there is a lot of non-linearity in the <code>mpg</code> data,
especially for <code>acceleration</code>, <code>weight</code>, <code>displacement</code>, <code>horsepower</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">rss <span style="color:#f92672">=</span> <span style="color:#a6e22e">rep</span>(<span style="color:#66d9ef">NA</span>, <span style="color:#ae81ff">10</span>)
fits <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>()
<span style="color:#a6e22e">for </span>(d in <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>) {
    fits[[d]] <span style="color:#f92672">=</span> <span style="color:#a6e22e">lm</span>(mpg <span style="color:#f92672">~</span> <span style="color:#a6e22e">poly</span>(displacement, d), data <span style="color:#f92672">=</span> autoDat)
    rss[d] <span style="color:#f92672">=</span> <span style="color:#a6e22e">deviance</span>(fits[[d]])
}
rss <span style="color:#f92672">%&gt;%</span> print</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##  [1] 8378.822 7412.263 7392.322 7391.722 7380.838 7270.746 7089.716 6917.401
##  [9] 6737.801 6610.190</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">anova</span>(fits[[1]],fits[[2]],fits[[3]],fits[[4]],fits[[5]],
  fits[[6]],fits[[7]],fits[[8]],fits[[9]],fits[[10]])</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Analysis of Variance Table
##
## Model  1: mpg ~ poly(displacement, d)
## Model  2: mpg ~ poly(displacement, d)
## Model  3: mpg ~ poly(displacement, d)
## Model  4: mpg ~ poly(displacement, d)
## Model  5: mpg ~ poly(displacement, d)
## Model  6: mpg ~ poly(displacement, d)
## Model  7: mpg ~ poly(displacement, d)
## Model  8: mpg ~ poly(displacement, d)
## Model  9: mpg ~ poly(displacement, d)
## Model 10: mpg ~ poly(displacement, d)
##    Res.Df    RSS Df Sum of Sq       F    Pr(&gt;F)
## 1     390 8378.8
## 2     389 7412.3  1    966.56 55.7108 5.756e-13 ***
## 3     388 7392.3  1     19.94  1.1494  0.284364
## 4     387 7391.7  1      0.60  0.0346  0.852549
## 5     386 7380.8  1     10.88  0.6273  0.428823
## 6     385 7270.7  1    110.09  6.3455  0.012177 *
## 7     384 7089.7  1    181.03 10.4343  0.001344 **
## 8     383 6917.4  1    172.31  9.9319  0.001753 **
## 9     382 6737.8  1    179.60 10.3518  0.001404 **
## 10    381 6610.2  1    127.61  7.3553  0.006990 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre></div>
<p>Confirming our visual indications, we see that the second degree models
work well.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">library</span>(glmnet)</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Loading required package: Matrix</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##
## Attaching package: &#39;Matrix&#39;</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## The following objects are masked from &#39;package:tidyr&#39;:
##
##     expand, pack, unpack</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Loaded glmnet 3.0-2</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">library</span>(boot)</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">cv.errs <span style="color:#f92672">=</span> <span style="color:#a6e22e">rep</span>(<span style="color:#66d9ef">NA</span>, <span style="color:#ae81ff">15</span>)
<span style="color:#a6e22e">for </span>(d in <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">15</span>) {
    fit <span style="color:#f92672">=</span> <span style="color:#a6e22e">glm</span>(mpg <span style="color:#f92672">~</span> <span style="color:#a6e22e">poly</span>(displacement, d), data <span style="color:#f92672">=</span> Auto)
    cv.errs[d] <span style="color:#f92672">=</span> <span style="color:#a6e22e">cv.glm</span>(Auto, fit, K <span style="color:#f92672">=</span> <span style="color:#ae81ff">15</span>)<span style="color:#f92672">$</span>delta[2]
}
<span style="color:#a6e22e">which.min</span>(cv.errs)</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## [1] 10</code></pre></div>
<p>Strangely, we seem to have ended up with a ten variable model here.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#75715e"># Step functions</span>
cv.errs <span style="color:#f92672">=</span> <span style="color:#a6e22e">rep</span>(<span style="color:#66d9ef">NA</span>, <span style="color:#ae81ff">10</span>)
<span style="color:#a6e22e">for </span>(c in <span style="color:#ae81ff">2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>) {
    Auto<span style="color:#f92672">$</span>dis.cut <span style="color:#f92672">=</span> <span style="color:#a6e22e">cut</span>(Auto<span style="color:#f92672">$</span>displacement, c)
    fit <span style="color:#f92672">=</span> <span style="color:#a6e22e">glm</span>(mpg <span style="color:#f92672">~</span> dis.cut, data <span style="color:#f92672">=</span> Auto)
    cv.errs[c] <span style="color:#f92672">=</span> <span style="color:#a6e22e">cv.glm</span>(Auto, fit, K <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>)<span style="color:#f92672">$</span>delta[2]
}
<span style="color:#a6e22e">which.min</span>(cv.errs) <span style="color:#f92672">%&gt;%</span> print</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## [1] 9</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">library</span>(splines)
cv.errs <span style="color:#f92672">=</span> <span style="color:#a6e22e">rep</span>(<span style="color:#66d9ef">NA</span>, <span style="color:#ae81ff">10</span>)
<span style="color:#a6e22e">for </span>(df in <span style="color:#ae81ff">3</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>) {
    fit <span style="color:#f92672">=</span> <span style="color:#a6e22e">glm</span>(mpg <span style="color:#f92672">~</span> <span style="color:#a6e22e">ns</span>(displacement, df <span style="color:#f92672">=</span> df), data <span style="color:#f92672">=</span> Auto)
    cv.errs[df] <span style="color:#f92672">=</span> <span style="color:#a6e22e">cv.glm</span>(Auto, fit, K <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>)<span style="color:#f92672">$</span>delta[2]
}
<span style="color:#a6e22e">which.min</span>(cv.errs) <span style="color:#f92672">%&gt;%</span> print</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## [1] 10</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">library</span>(gam)</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Loading required package: foreach</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##
## Attaching package: &#39;foreach&#39;</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## The following objects are masked from &#39;package:purrr&#39;:
##
##     accumulate, when</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Loaded gam 1.16.1</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#75715e"># GAMs</span>
fit <span style="color:#f92672">=</span> <span style="color:#a6e22e">gam</span>(mpg <span style="color:#f92672">~</span> <span style="color:#a6e22e">s</span>(displacement, <span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> <span style="color:#a6e22e">s</span>(horsepower, <span style="color:#ae81ff">4</span>), data <span style="color:#f92672">=</span> Auto)</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">summary</span>(fit)</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##
## Call: gam(formula = mpg ~ s(displacement, 4) + s(horsepower, 4), data = Auto)
## Deviance Residuals:
##      Min       1Q   Median       3Q      Max
## -11.2982  -2.1592  -0.4394   2.1247  17.0946
##
## (Dispersion Parameter for gaussian family taken to be 15.3543)
##
##     Null Deviance: 23818.99 on 391 degrees of freedom
## Residual Deviance: 5880.697 on 382.9999 degrees of freedom
## AIC: 2194.05
##
## Number of Local Scoring Iterations: 2
##
## Anova for Parametric Effects
##                     Df  Sum Sq Mean Sq F value  Pr(&gt;F)
## s(displacement, 4)   1 15254.9 15254.9 993.524 &lt; 2e-16 ***
## s(horsepower, 4)     1  1038.4  1038.4  67.632 3.1e-15 ***
## Residuals          383  5880.7    15.4
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
##
## Anova for Nonparametric Effects
##                    Npar Df Npar F     Pr(F)
## (Intercept)
## s(displacement, 4)       3 13.613 1.863e-08 ***
## s(horsepower, 4)         3 15.606 1.349e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre></div>
<h2 id="question-7.9---pages-299-300">Question 7.9 - Pages 299-300</h2>

<p>This question uses the variables <code>dis</code> (the weighted mean of distances
to five <code>Boston</code> employment centers) and <code>nox</code> (nitrogen oxides
concentration in parts per 10 million) from the <code>Boston</code> data. We will
treat <code>dis</code> as the predictor and <code>nox</code> as the response.</p>

<p><strong>(a)</strong> Use the <code>poly()</code> function to fit a cubic polynomial regression to
predict <code>nox</code> using <code>dis</code>. Report the regression output, and plot the
resulting data and polynomial fits.</p>

<p><strong>(b)</strong> Plot the polynomial fits for a range of different polynomial
degrees (say, from 1 to 10), and report the associated residual sum of
squares.</p>

<p><strong>&copy;</strong> Perform cross-validation or another approach to select the optimal
degree for the polynomial, and explain your results.</p>

<p><strong>(d)</strong> Use the <code>bs()</code> function to fit a regression spline to predict nox
using <code>dis</code>. Report the output for the fit using four degrees of
freedom. How did you choose the knots? Plot the resulting fit.</p>

<p><strong>(e)</strong> Now fit a regression spline for a range of degrees of freedom, and
plot the resulting fits and report the resulting RSS. Describe the
results obtained.</p>

<p><strong>(f)</strong> Perform cross-validation or another approach in order to select
the best degrees of freedom for a regression spline on this data.
Describe your results.</p>

<h3 id="answer-2">Answer</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">boston<span style="color:#f92672">&lt;-</span>MASS<span style="color:#f92672">::</span>Boston
boston <span style="color:#f92672">%&gt;%</span> str <span style="color:#f92672">%&gt;%</span> print</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## &#39;data.frame&#39;:    506 obs. of  14 variables:
##  $ crim   : num  0.00632 0.02731 0.02729 0.03237 0.06905 ...
##  $ zn     : num  18 0 0 0 0 0 12.5 12.5 12.5 12.5 ...
##  $ indus  : num  2.31 7.07 7.07 2.18 2.18 2.18 7.87 7.87 7.87 7.87 ...
##  $ chas   : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ nox    : num  0.538 0.469 0.469 0.458 0.458 0.458 0.524 0.524 0.524 0.524 ...
##  $ rm     : num  6.58 6.42 7.18 7 7.15 ...
##  $ age    : num  65.2 78.9 61.1 45.8 54.2 58.7 66.6 96.1 100 85.9 ...
##  $ dis    : num  4.09 4.97 4.97 6.06 6.06 ...
##  $ rad    : int  1 2 2 3 3 3 5 5 5 5 ...
##  $ tax    : num  296 242 242 222 222 222 311 311 311 311 ...
##  $ ptratio: num  15.3 17.8 17.8 18.7 18.7 18.7 15.2 15.2 15.2 15.2 ...
##  $ black  : num  397 397 393 395 397 ...
##  $ lstat  : num  4.98 9.14 4.03 2.94 5.33 ...
##  $ medv   : num  24 21.6 34.7 33.4 36.2 28.7 22.9 27.1 16.5 18.9 ...
## NULL</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">boston <span style="color:#f92672">%&gt;%</span> summary <span style="color:#f92672">%&gt;%</span> print</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##       crim                zn             indus            chas
##  Min.   : 0.00632   Min.   :  0.00   Min.   : 0.46   Min.   :0.00000
##  1st Qu.: 0.08204   1st Qu.:  0.00   1st Qu.: 5.19   1st Qu.:0.00000
##  Median : 0.25651   Median :  0.00   Median : 9.69   Median :0.00000
##  Mean   : 3.61352   Mean   : 11.36   Mean   :11.14   Mean   :0.06917
##  3rd Qu.: 3.67708   3rd Qu.: 12.50   3rd Qu.:18.10   3rd Qu.:0.00000
##  Max.   :88.97620   Max.   :100.00   Max.   :27.74   Max.   :1.00000
##       nox               rm             age              dis
##  Min.   :0.3850   Min.   :3.561   Min.   :  2.90   Min.   : 1.130
##  1st Qu.:0.4490   1st Qu.:5.886   1st Qu.: 45.02   1st Qu.: 2.100
##  Median :0.5380   Median :6.208   Median : 77.50   Median : 3.207
##  Mean   :0.5547   Mean   :6.285   Mean   : 68.57   Mean   : 3.795
##  3rd Qu.:0.6240   3rd Qu.:6.623   3rd Qu.: 94.08   3rd Qu.: 5.188
##  Max.   :0.8710   Max.   :8.780   Max.   :100.00   Max.   :12.127
##       rad              tax           ptratio          black
##  Min.   : 1.000   Min.   :187.0   Min.   :12.60   Min.   :  0.32
##  1st Qu.: 4.000   1st Qu.:279.0   1st Qu.:17.40   1st Qu.:375.38
##  Median : 5.000   Median :330.0   Median :19.05   Median :391.44
##  Mean   : 9.549   Mean   :408.2   Mean   :18.46   Mean   :356.67
##  3rd Qu.:24.000   3rd Qu.:666.0   3rd Qu.:20.20   3rd Qu.:396.23
##  Max.   :24.000   Max.   :711.0   Max.   :22.00   Max.   :396.90
##      lstat            medv
##  Min.   : 1.73   Min.   : 5.00
##  1st Qu.: 6.95   1st Qu.:17.02
##  Median :11.36   Median :21.20
##  Mean   :12.65   Mean   :22.53
##  3rd Qu.:16.95   3rd Qu.:25.00
##  Max.   :37.97   Max.   :50.00</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">boston <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">sapply</span>(unique) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">sapply</span>(length) <span style="color:#f92672">%&gt;%</span> print</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##    crim      zn   indus    chas     nox      rm     age     dis     rad     tax
##     504      26      76       2      81     446     356     412       9      66
## ptratio   black   lstat    medv
##      46     357     455     229</code></pre></div>
<h4 id="a-polynomial">a) Polynomial</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">fit.03 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(nox<span style="color:#f92672">~</span><span style="color:#a6e22e">poly</span>(dis,<span style="color:#ae81ff">3</span>), data<span style="color:#f92672">=</span>boston)
dislims <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">range</span>(boston<span style="color:#f92672">$</span>dis)
dis.grid <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">seq</span>(dislims[1], dislims[2], <span style="color:#ae81ff">0.1</span>)
preds <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">predict</span>(fit.03, newdata<span style="color:#f92672">=</span><span style="color:#a6e22e">list</span>(dis<span style="color:#f92672">=</span>dis.grid), se<span style="color:#f92672">=</span><span style="color:#66d9ef">TRUE</span>)
se.bands <span style="color:#f92672">&lt;-</span> preds<span style="color:#f92672">$</span>fit <span style="color:#f92672">+</span> <span style="color:#a6e22e">cbind</span>(<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>preds<span style="color:#f92672">$</span>se.fit, <span style="color:#ae81ff">-2</span><span style="color:#f92672">*</span>preds<span style="color:#f92672">$</span>se.fit)
<span style="color:#a6e22e">par</span>(mfrow<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>), mar<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">4.5</span>,<span style="color:#ae81ff">4.5</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>), oma<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">0</span>))
<span style="color:#a6e22e">plot</span>(boston<span style="color:#f92672">$</span>dis, boston<span style="color:#f92672">$</span>nox, xlim<span style="color:#f92672">=</span>dislims, cex<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>, col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;darkgrey&#34;</span>)
<span style="color:#a6e22e">title</span>(<span style="color:#e6db74">&#34;Degree 3 Polynomial Fit&#34;</span>)
<span style="color:#a6e22e">lines</span>(dis.grid, preds<span style="color:#f92672">$</span>fit, lwd<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;blue&#34;</span>)
<span style="color:#a6e22e">matlines</span>(dis.grid, se.bands, lwd<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;blue&#34;</span>, lty<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)</code></pre></div>

    <figure class="left" >
        <img src="https://rgoswami.me/islr/sol5/unnamed-chunk-20-1.png"   />

        
    </figure>


<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">summary</span>(fit.03)</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##
## Call:
## lm(formula = nox ~ poly(dis, 3), data = boston)
##
## Residuals:
##       Min        1Q    Median        3Q       Max
## -0.121130 -0.040619 -0.009738  0.023385  0.194904
##
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)    0.554695   0.002759 201.021  &lt; 2e-16 ***
## poly(dis, 3)1 -2.003096   0.062071 -32.271  &lt; 2e-16 ***
## poly(dis, 3)2  0.856330   0.062071  13.796  &lt; 2e-16 ***
## poly(dis, 3)3 -0.318049   0.062071  -5.124 4.27e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
##
## Residual standard error: 0.06207 on 502 degrees of freedom
## Multiple R-squared:  0.7148, Adjusted R-squared:  0.7131
## F-statistic: 419.3 on 3 and 502 DF,  p-value: &lt; 2.2e-16</code></pre></div>
<h4 id="b-multiple-polynomials">b) Multiple Polynomials</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">rss.error <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rep</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">10</span>)
<span style="color:#a6e22e">for </span>(i in <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>) {
  lm.fit <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(nox<span style="color:#f92672">~</span><span style="color:#a6e22e">poly</span>(dis,i), data<span style="color:#f92672">=</span>boston)
  rss.error[i] <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sum</span>(lm.fit<span style="color:#f92672">$</span>residuals^2)
}
rss.error</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##  [1] 2.768563 2.035262 1.934107 1.932981 1.915290 1.878257 1.849484 1.835630
##  [9] 1.833331 1.832171</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">plot</span>(rss.error, type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>)</code></pre></div>

    <figure class="left" >
        <img src="https://rgoswami.me/islr/sol5/unnamed-chunk-21-1.png"   />

        
    </figure>



<h4 id="c-cross-validation-and-polynomial-selection">c) Cross validation and polynomial selection</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">require</span>(boot)
<span style="color:#a6e22e">set.seed</span>(<span style="color:#ae81ff">1</span>)
cv.error <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rep</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">10</span>)
<span style="color:#a6e22e">for </span>(i in <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>) {
  glm.fit <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">glm</span>(nox<span style="color:#f92672">~</span><span style="color:#a6e22e">poly</span>(dis,i), data<span style="color:#f92672">=</span>boston)
  cv.error[i] <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cv.glm</span>(boston, glm.fit, K<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)<span style="color:#f92672">$</span>delta[1]  <span style="color:#75715e"># [1]:std, [2]:bias-corrected</span>
}
cv.error</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##  [1] 0.005558263 0.004085706 0.003876521 0.003863342 0.004237452 0.005686862
##  [7] 0.010278897 0.006810868 0.033308607 0.004075599</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">plot</span>(cv.error, type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>)</code></pre></div>

    <figure class="left" >
        <img src="https://rgoswami.me/islr/sol5/unnamed-chunk-22-1.png"   />

        
    </figure>



<ul>
<li>I feel like the second degree fit would be the most reasonable, though
the fourth degree seems to be doing well.</li>
</ul>

<h4 id="d-regression-spline">d) Regression spline</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">fit.sp <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(nox<span style="color:#f92672">~</span><span style="color:#a6e22e">bs</span>(dis, df<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>), data<span style="color:#f92672">=</span>boston)
pred <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">predict</span>(fit.sp, newdata<span style="color:#f92672">=</span><span style="color:#a6e22e">list</span>(dis<span style="color:#f92672">=</span>dis.grid), se<span style="color:#f92672">=</span>T)
<span style="color:#a6e22e">plot</span>(boston<span style="color:#f92672">$</span>dis, boston<span style="color:#f92672">$</span>nox, col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;gray&#34;</span>)
<span style="color:#a6e22e">lines</span>(dis.grid, pred<span style="color:#f92672">$</span>fit, lwd<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
<span style="color:#a6e22e">lines</span>(dis.grid, pred<span style="color:#f92672">$</span>fit<span style="color:#ae81ff">+2</span><span style="color:#f92672">*</span>pred<span style="color:#f92672">$</span>se, lty<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dashed&#34;</span>)
<span style="color:#a6e22e">lines</span>(dis.grid, pred<span style="color:#f92672">$</span>fit<span style="color:#ae81ff">-2</span><span style="color:#f92672">*</span>pred<span style="color:#f92672">$</span>se, lty<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dashed&#34;</span>)</code></pre></div>

    <figure class="left" >
        <img src="https://rgoswami.me/islr/sol5/unnamed-chunk-23-1.png"   />

        
    </figure>


<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#75715e"># set df to select knots at uniform quantiles of `dis`</span>
<span style="color:#a6e22e">attr</span>(<span style="color:#a6e22e">bs</span>(boston<span style="color:#f92672">$</span>dis,df<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>),<span style="color:#e6db74">&#34;knots&#34;</span>)  <span style="color:#75715e"># only 1 knot at 50th percentile</span></code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##     50%
## 3.20745</code></pre></div>
<h4 id="e-range-of-regression-splines">e) Range of regression splines</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">rss.error <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rep</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">7</span>)
<span style="color:#a6e22e">for </span>(i in <span style="color:#ae81ff">4</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>) {
  fit.sp <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(nox<span style="color:#f92672">~</span><span style="color:#a6e22e">bs</span>(dis, df<span style="color:#f92672">=</span>i), data<span style="color:#f92672">=</span>boston)
  rss.error[i<span style="color:#ae81ff">-3</span>] <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sum</span>(fit.sp<span style="color:#f92672">$</span>residuals^2)
}
rss.error</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## [1] 1.922775 1.840173 1.833966 1.829884 1.816995 1.825653 1.792535</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">plot</span>(<span style="color:#ae81ff">4</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>, rss.error, type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>)</code></pre></div>

    <figure class="left" >
        <img src="https://rgoswami.me/islr/sol5/unnamed-chunk-24-1.png"   />

        
    </figure>



<ul>
<li>As the model gains more degrees of freedom, it tends to over fit to
the training data better</li>
</ul>

<h4 id="f-cross-validation-for-best-spline">f) Cross validation for best spline</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">cv.error <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rep</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">7</span>)
<span style="color:#a6e22e">for </span>(i in <span style="color:#ae81ff">4</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>) {
  glm.fit <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">glm</span>(nox<span style="color:#f92672">~</span><span style="color:#a6e22e">bs</span>(dis, df<span style="color:#f92672">=</span>i), data<span style="color:#f92672">=</span>boston)
  cv.error[i<span style="color:#ae81ff">-3</span>] <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cv.glm</span>(boston, glm.fit, K<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)<span style="color:#f92672">$</span>delta[1]
}</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Warning in bs(dis, degree = 3L, knots = c(`50%` = 3.1523), Boundary.knots =
## c(1.1296, : some &#39;x&#39; values beyond boundary knots may cause ill-conditioned
## bases

## Warning in bs(dis, degree = 3L, knots = c(`50%` = 3.1523), Boundary.knots =
## c(1.1296, : some &#39;x&#39; values beyond boundary knots may cause ill-conditioned
## bases</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Warning in bs(dis, degree = 3L, knots = c(`50%` = 3.2157), Boundary.knots =
## c(1.137, : some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases

## Warning in bs(dis, degree = 3L, knots = c(`50%` = 3.2157), Boundary.knots =
## c(1.137, : some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Warning in bs(dis, degree = 3L, knots = c(`33.33333%` = 2.35953333333333, : some
## &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases

## Warning in bs(dis, degree = 3L, knots = c(`33.33333%` = 2.35953333333333, : some
## &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Warning in bs(dis, degree = 3L, knots = c(`33.33333%` = 2.38403333333333, : some
## &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases

## Warning in bs(dis, degree = 3L, knots = c(`33.33333%` = 2.38403333333333, : some
## &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Warning in bs(dis, degree = 3L, knots = c(`25%` = 2.07945, `50%` = 3.1323, :
## some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases

## Warning in bs(dis, degree = 3L, knots = c(`25%` = 2.07945, `50%` = 3.1323, :
## some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Warning in bs(dis, degree = 3L, knots = c(`25%` = 2.1103, `50%` = 3.2797, : some
## &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases

## Warning in bs(dis, degree = 3L, knots = c(`25%` = 2.1103, `50%` = 3.2797, : some
## &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Warning in bs(dis, degree = 3L, knots = c(`20%` = 1.9682, `40%` = 2.7147, : some
## &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases

## Warning in bs(dis, degree = 3L, knots = c(`20%` = 1.9682, `40%` = 2.7147, : some
## &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Warning in bs(dis, degree = 3L, knots = c(`20%` = 1.95434, `40%` = 2.59666, :
## some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases

## Warning in bs(dis, degree = 3L, knots = c(`20%` = 1.95434, `40%` = 2.59666, :
## some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Warning in bs(dis, degree = 3L, knots = c(`16.66667%` = 1.82203333333333, : some
## &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases

## Warning in bs(dis, degree = 3L, knots = c(`16.66667%` = 1.82203333333333, : some
## &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Warning in bs(dis, degree = 3L, knots = c(`16.66667%` = 1.8226, `33.33333%` =
## 2.3817, : some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases

## Warning in bs(dis, degree = 3L, knots = c(`16.66667%` = 1.8226, `33.33333%` =
## 2.3817, : some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Warning in bs(dis, degree = 3L, knots = c(`14.28571%` = 1.7936, `28.57143%`
## = 2.16972857142857, : some &#39;x&#39; values beyond boundary knots may cause ill-
## conditioned bases

## Warning in bs(dis, degree = 3L, knots = c(`14.28571%` = 1.7936, `28.57143%`
## = 2.16972857142857, : some &#39;x&#39; values beyond boundary knots may cause ill-
## conditioned bases</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Warning in bs(dis, degree = 3L, knots = c(`12.5%` = 1.754625, `25%` = 2.10215, :
## some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases

## Warning in bs(dis, degree = 3L, knots = c(`12.5%` = 1.754625, `25%` = 2.10215, :
## some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Warning in bs(dis, degree = 3L, knots = c(`12.5%` = 1.751575, `25%` = 2.08755, :
## some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases

## Warning in bs(dis, degree = 3L, knots = c(`12.5%` = 1.751575, `25%` = 2.08755, :
## some &#39;x&#39; values beyond boundary knots may cause ill-conditioned bases</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">cv.error</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## [1] 0.003898810 0.003694675 0.003732665 0.003766202 0.003716389 0.003723126
## [7] 0.003727358</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">plot</span>(<span style="color:#ae81ff">4</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>, cv.error, type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>)</code></pre></div>

    <figure class="left" >
        <img src="https://rgoswami.me/islr/sol5/unnamed-chunk-25-1.png"   />

        
    </figure>



<ul>
<li>A fifth degree polynomial is clearly indicated</li>
</ul>

<h2 id="question-10---page-300">Question 10 - Page 300</h2>

<p>This question relates to the <code>College</code> data set.</p>

<p><strong>(a)</strong> Split the data into a training set and a test set. Using
out-of-state tuition as the response and the other variables as the
predictors, perform forward stepwise selection on the training set in
order to identify a satisfactory model that uses just a subset of the
predictors.</p>

<p><strong>(b)</strong> Fit a GAM on the training data, using out-of-state tuition as the
response and the features selected in the previous step as the
predictors. Plot the results, and explain your ﬁndings.</p>

<p><strong>&copy;</strong> Evaluate the model obtained on the test set, and explain the
results obtained.</p>

<p><strong>(d)</strong> For which variables, if any, is there evidence of a non-linear
relationship with the response?</p>

<h3 id="answer-3">Answer</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">colDat<span style="color:#f92672">&lt;-</span>ISLR<span style="color:#f92672">::</span>College
colDat <span style="color:#f92672">%&gt;%</span> str <span style="color:#f92672">%&gt;%</span> print</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## &#39;data.frame&#39;:    777 obs. of  18 variables:
##  $ Private    : Factor w/ 2 levels &#34;No&#34;,&#34;Yes&#34;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ Apps       : num  1660 2186 1428 417 193 ...
##  $ Accept     : num  1232 1924 1097 349 146 ...
##  $ Enroll     : num  721 512 336 137 55 158 103 489 227 172 ...
##  $ Top10perc  : num  23 16 22 60 16 38 17 37 30 21 ...
##  $ Top25perc  : num  52 29 50 89 44 62 45 68 63 44 ...
##  $ F.Undergrad: num  2885 2683 1036 510 249 ...
##  $ P.Undergrad: num  537 1227 99 63 869 ...
##  $ Outstate   : num  7440 12280 11250 12960 7560 ...
##  $ Room.Board : num  3300 6450 3750 5450 4120 ...
##  $ Books      : num  450 750 400 450 800 500 500 450 300 660 ...
##  $ Personal   : num  2200 1500 1165 875 1500 ...
##  $ PhD        : num  70 29 53 92 76 67 90 89 79 40 ...
##  $ Terminal   : num  78 30 66 97 72 73 93 100 84 41 ...
##  $ S.F.Ratio  : num  18.1 12.2 12.9 7.7 11.9 9.4 11.5 13.7 11.3 11.5 ...
##  $ perc.alumni: num  12 16 30 37 2 11 26 37 23 15 ...
##  $ Expend     : num  7041 10527 8735 19016 10922 ...
##  $ Grad.Rate  : num  60 56 54 59 15 55 63 73 80 52 ...
## NULL</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">colDat <span style="color:#f92672">%&gt;%</span> summary <span style="color:#f92672">%&gt;%</span> print</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##  Private        Apps           Accept          Enroll       Top10perc
##  No :212   Min.   :   81   Min.   :   72   Min.   :  35   Min.   : 1.00
##  Yes:565   1st Qu.:  776   1st Qu.:  604   1st Qu.: 242   1st Qu.:15.00
##            Median : 1558   Median : 1110   Median : 434   Median :23.00
##            Mean   : 3002   Mean   : 2019   Mean   : 780   Mean   :27.56
##            3rd Qu.: 3624   3rd Qu.: 2424   3rd Qu.: 902   3rd Qu.:35.00
##            Max.   :48094   Max.   :26330   Max.   :6392   Max.   :96.00
##    Top25perc      F.Undergrad     P.Undergrad         Outstate
##  Min.   :  9.0   Min.   :  139   Min.   :    1.0   Min.   : 2340
##  1st Qu.: 41.0   1st Qu.:  992   1st Qu.:   95.0   1st Qu.: 7320
##  Median : 54.0   Median : 1707   Median :  353.0   Median : 9990
##  Mean   : 55.8   Mean   : 3700   Mean   :  855.3   Mean   :10441
##  3rd Qu.: 69.0   3rd Qu.: 4005   3rd Qu.:  967.0   3rd Qu.:12925
##  Max.   :100.0   Max.   :31643   Max.   :21836.0   Max.   :21700
##    Room.Board       Books           Personal         PhD
##  Min.   :1780   Min.   :  96.0   Min.   : 250   Min.   :  8.00
##  1st Qu.:3597   1st Qu.: 470.0   1st Qu.: 850   1st Qu.: 62.00
##  Median :4200   Median : 500.0   Median :1200   Median : 75.00
##  Mean   :4358   Mean   : 549.4   Mean   :1341   Mean   : 72.66
##  3rd Qu.:5050   3rd Qu.: 600.0   3rd Qu.:1700   3rd Qu.: 85.00
##  Max.   :8124   Max.   :2340.0   Max.   :6800   Max.   :103.00
##     Terminal       S.F.Ratio      perc.alumni        Expend
##  Min.   : 24.0   Min.   : 2.50   Min.   : 0.00   Min.   : 3186
##  1st Qu.: 71.0   1st Qu.:11.50   1st Qu.:13.00   1st Qu.: 6751
##  Median : 82.0   Median :13.60   Median :21.00   Median : 8377
##  Mean   : 79.7   Mean   :14.09   Mean   :22.74   Mean   : 9660
##  3rd Qu.: 92.0   3rd Qu.:16.50   3rd Qu.:31.00   3rd Qu.:10830
##  Max.   :100.0   Max.   :39.80   Max.   :64.00   Max.   :56233
##    Grad.Rate
##  Min.   : 10.00
##  1st Qu.: 53.00
##  Median : 65.00
##  Mean   : 65.46
##  3rd Qu.: 78.00
##  Max.   :118.00</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">colDat <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">sapply</span>(unique) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">sapply</span>(length) <span style="color:#f92672">%&gt;%</span> print</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##     Private        Apps      Accept      Enroll   Top10perc   Top25perc
##           2         711         693         581          82          89
## F.Undergrad P.Undergrad    Outstate  Room.Board       Books    Personal
##         714         566         640         553         122         294
##         PhD    Terminal   S.F.Ratio perc.alumni      Expend   Grad.Rate
##          78          65         173          61         744          81</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">plotLEAP<span style="color:#f92672">=</span><span style="color:#a6e22e">function</span>(leapObj){
  <span style="color:#a6e22e">par</span>(mfrow <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">2</span>))
  bar2<span style="color:#f92672">=</span><span style="color:#a6e22e">which.max</span>(leapObj<span style="color:#f92672">$</span>adjr2)
  bbic<span style="color:#f92672">=</span><span style="color:#a6e22e">which.min</span>(leapObj<span style="color:#f92672">$</span>bic)
  bcp<span style="color:#f92672">=</span><span style="color:#a6e22e">which.min</span>(leapObj<span style="color:#f92672">$</span>cp)
  <span style="color:#a6e22e">plot</span>(leapObj<span style="color:#f92672">$</span>rss,xlab<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Number of variables&#34;</span>,ylab<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;RSS&#34;</span>,type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>)
  <span style="color:#a6e22e">plot</span>(leapObj<span style="color:#f92672">$</span>adjr2,xlab<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Number of variables&#34;</span>,ylab<span style="color:#f92672">=</span><span style="color:#a6e22e">TeX</span>(<span style="color:#e6db74">&#34;Adjusted R^2&#34;</span>),type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>)
  <span style="color:#a6e22e">points</span>(bar2,leapObj<span style="color:#f92672">$</span>adjr2[bar2],col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;green&#34;</span>,cex<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,pch<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
  <span style="color:#a6e22e">plot</span>(leapObj<span style="color:#f92672">$</span>bic,xlab<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Number of variables&#34;</span>,ylab<span style="color:#f92672">=</span><span style="color:#a6e22e">TeX</span>(<span style="color:#e6db74">&#34;BIC&#34;</span>),type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>)
  <span style="color:#a6e22e">points</span>(bbic,leapObj<span style="color:#f92672">$</span>bic[bbic],col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;blue&#34;</span>,cex<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,pch<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
  <span style="color:#a6e22e">plot</span>(leapObj<span style="color:#f92672">$</span>cp,xlab<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Number of variables&#34;</span>,ylab<span style="color:#f92672">=</span><span style="color:#a6e22e">TeX</span>(<span style="color:#e6db74">&#34;C_p&#34;</span>),type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>)
  <span style="color:#a6e22e">points</span>(bcp,leapObj<span style="color:#f92672">$</span>cp[bcp],col<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;red&#34;</span>,cex<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,pch<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
}</code></pre></div>
<h4 id="a-train-test">a) Train test</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">train_ind <span style="color:#f92672">=</span> <span style="color:#a6e22e">sample</span>(colDat <span style="color:#f92672">%&gt;%</span> nrow,<span style="color:#ae81ff">100</span>)
test_ind <span style="color:#f92672">=</span> <span style="color:#a6e22e">setdiff</span>(<span style="color:#a6e22e">seq_len</span>(colDat <span style="color:#f92672">%&gt;%</span> nrow), train_ind)</code></pre></div>
<h4 id="best-subset-selection">Best subset selection</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">train_set<span style="color:#f92672">&lt;-</span>colDat[train_ind,]
test_set<span style="color:#f92672">&lt;-</span>colDat[<span style="color:#f92672">-</span>train_ind,]</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">library</span>(leaps)</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">modelFit<span style="color:#f92672">&lt;-</span><span style="color:#a6e22e">regsubsets</span>(Outstate<span style="color:#f92672">~</span>.,data<span style="color:#f92672">=</span>colDat,nvmax<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
modelFit <span style="color:#f92672">%&gt;%</span> summary <span style="color:#f92672">%&gt;%</span> print</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Subset selection object
## Call: regsubsets.formula(Outstate ~ ., data = colDat, nvmax = 20)
## 17 Variables  (and intercept)
##             Forced in Forced out
## PrivateYes      FALSE      FALSE
## Apps            FALSE      FALSE
## Accept          FALSE      FALSE
## Enroll          FALSE      FALSE
## Top10perc       FALSE      FALSE
## Top25perc       FALSE      FALSE
## F.Undergrad     FALSE      FALSE
## P.Undergrad     FALSE      FALSE
## Room.Board      FALSE      FALSE
## Books           FALSE      FALSE
## Personal        FALSE      FALSE
## PhD             FALSE      FALSE
## Terminal        FALSE      FALSE
## S.F.Ratio       FALSE      FALSE
## perc.alumni     FALSE      FALSE
## Expend          FALSE      FALSE
## Grad.Rate       FALSE      FALSE
## 1 subsets of each size up to 17
## Selection Algorithm: exhaustive
##           PrivateYes Apps Accept Enroll Top10perc Top25perc F.Undergrad
## 1  ( 1 )  &#34; &#34;        &#34; &#34;  &#34; &#34;    &#34; &#34;    &#34; &#34;       &#34; &#34;       &#34; &#34;
## 2  ( 1 )  &#34;*&#34;        &#34; &#34;  &#34; &#34;    &#34; &#34;    &#34; &#34;       &#34; &#34;       &#34; &#34;
## 3  ( 1 )  &#34;*&#34;        &#34; &#34;  &#34; &#34;    &#34; &#34;    &#34; &#34;       &#34; &#34;       &#34; &#34;
## 4  ( 1 )  &#34;*&#34;        &#34; &#34;  &#34; &#34;    &#34; &#34;    &#34; &#34;       &#34; &#34;       &#34; &#34;
## 5  ( 1 )  &#34;*&#34;        &#34; &#34;  &#34; &#34;    &#34; &#34;    &#34; &#34;       &#34; &#34;       &#34; &#34;
## 6  ( 1 )  &#34;*&#34;        &#34; &#34;  &#34; &#34;    &#34; &#34;    &#34; &#34;       &#34; &#34;       &#34; &#34;
## 7  ( 1 )  &#34;*&#34;        &#34; &#34;  &#34; &#34;    &#34; &#34;    &#34; &#34;       &#34; &#34;       &#34; &#34;
## 8  ( 1 )  &#34;*&#34;        &#34; &#34;  &#34;*&#34;    &#34; &#34;    &#34; &#34;       &#34; &#34;       &#34;*&#34;
## 9  ( 1 )  &#34;*&#34;        &#34;*&#34;  &#34;*&#34;    &#34; &#34;    &#34; &#34;       &#34; &#34;       &#34;*&#34;
## 10  ( 1 ) &#34;*&#34;        &#34;*&#34;  &#34;*&#34;    &#34; &#34;    &#34;*&#34;       &#34; &#34;       &#34;*&#34;
## 11  ( 1 ) &#34;*&#34;        &#34;*&#34;  &#34;*&#34;    &#34; &#34;    &#34;*&#34;       &#34; &#34;       &#34;*&#34;
## 12  ( 1 ) &#34;*&#34;        &#34;*&#34;  &#34;*&#34;    &#34; &#34;    &#34;*&#34;       &#34; &#34;       &#34;*&#34;
## 13  ( 1 ) &#34;*&#34;        &#34;*&#34;  &#34;*&#34;    &#34;*&#34;    &#34;*&#34;       &#34; &#34;       &#34;*&#34;
## 14  ( 1 ) &#34;*&#34;        &#34;*&#34;  &#34;*&#34;    &#34;*&#34;    &#34;*&#34;       &#34; &#34;       &#34;*&#34;
## 15  ( 1 ) &#34;*&#34;        &#34;*&#34;  &#34;*&#34;    &#34;*&#34;    &#34;*&#34;       &#34; &#34;       &#34;*&#34;
## 16  ( 1 ) &#34;*&#34;        &#34;*&#34;  &#34;*&#34;    &#34;*&#34;    &#34;*&#34;       &#34;*&#34;       &#34;*&#34;
## 17  ( 1 ) &#34;*&#34;        &#34;*&#34;  &#34;*&#34;    &#34;*&#34;    &#34;*&#34;       &#34;*&#34;       &#34;*&#34;
##           P.Undergrad Room.Board Books Personal PhD Terminal S.F.Ratio
## 1  ( 1 )  &#34; &#34;         &#34; &#34;        &#34; &#34;   &#34; &#34;      &#34; &#34; &#34; &#34;      &#34; &#34;
## 2  ( 1 )  &#34; &#34;         &#34; &#34;        &#34; &#34;   &#34; &#34;      &#34; &#34; &#34; &#34;      &#34; &#34;
## 3  ( 1 )  &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34; &#34;      &#34; &#34; &#34; &#34;      &#34; &#34;
## 4  ( 1 )  &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34; &#34;      &#34; &#34; &#34; &#34;      &#34; &#34;
## 5  ( 1 )  &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34; &#34;      &#34;*&#34; &#34; &#34;      &#34; &#34;
## 6  ( 1 )  &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34; &#34;      &#34; &#34; &#34;*&#34;      &#34; &#34;
## 7  ( 1 )  &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34;*&#34;      &#34; &#34; &#34;*&#34;      &#34; &#34;
## 8  ( 1 )  &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34; &#34;      &#34; &#34; &#34;*&#34;      &#34; &#34;
## 9  ( 1 )  &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34; &#34;      &#34; &#34; &#34;*&#34;      &#34; &#34;
## 10  ( 1 ) &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34; &#34;      &#34; &#34; &#34;*&#34;      &#34; &#34;
## 11  ( 1 ) &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34;*&#34;      &#34; &#34; &#34;*&#34;      &#34; &#34;
## 12  ( 1 ) &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34;*&#34;      &#34; &#34; &#34;*&#34;      &#34;*&#34;
## 13  ( 1 ) &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34;*&#34;      &#34; &#34; &#34;*&#34;      &#34;*&#34;
## 14  ( 1 ) &#34; &#34;         &#34;*&#34;        &#34; &#34;   &#34;*&#34;      &#34;*&#34; &#34;*&#34;      &#34;*&#34;
## 15  ( 1 ) &#34; &#34;         &#34;*&#34;        &#34;*&#34;   &#34;*&#34;      &#34;*&#34; &#34;*&#34;      &#34;*&#34;
## 16  ( 1 ) &#34; &#34;         &#34;*&#34;        &#34;*&#34;   &#34;*&#34;      &#34;*&#34; &#34;*&#34;      &#34;*&#34;
## 17  ( 1 ) &#34;*&#34;         &#34;*&#34;        &#34;*&#34;   &#34;*&#34;      &#34;*&#34; &#34;*&#34;      &#34;*&#34;
##           perc.alumni Expend Grad.Rate
## 1  ( 1 )  &#34; &#34;         &#34;*&#34;    &#34; &#34;
## 2  ( 1 )  &#34; &#34;         &#34;*&#34;    &#34; &#34;
## 3  ( 1 )  &#34; &#34;         &#34;*&#34;    &#34; &#34;
## 4  ( 1 )  &#34;*&#34;         &#34;*&#34;    &#34; &#34;
## 5  ( 1 )  &#34;*&#34;         &#34;*&#34;    &#34; &#34;
## 6  ( 1 )  &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
## 7  ( 1 )  &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
## 8  ( 1 )  &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
## 9  ( 1 )  &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
## 10  ( 1 ) &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
## 11  ( 1 ) &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
## 12  ( 1 ) &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
## 13  ( 1 ) &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
## 14  ( 1 ) &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
## 15  ( 1 ) &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
## 16  ( 1 ) &#34;*&#34;         &#34;*&#34;    &#34;*&#34;
## 17  ( 1 ) &#34;*&#34;         &#34;*&#34;    &#34;*&#34;</code></pre></div>
<p>We might want to take a look at these.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">par</span>(mfrow<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">2</span>))
<span style="color:#a6e22e">plot</span>(modelFit)
<span style="color:#a6e22e">plot</span>(modelFit,scale<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Cp&#39;</span>)
<span style="color:#a6e22e">plot</span>(modelFit,scale<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;r2&#39;</span>)
<span style="color:#a6e22e">plot</span>(modelFit,scale<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;adjr2&#39;</span>)</code></pre></div>

    <figure class="left" >
        <img src="https://rgoswami.me/islr/sol5/unnamed-chunk-32-1.png"   />

        
    </figure>


<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">plotLEAP</span>(modelFit <span style="color:#f92672">%&gt;%</span> summary)</code></pre></div>

    <figure class="left" >
        <img src="https://rgoswami.me/islr/sol5/unnamed-chunk-33-1.png"   />

        
    </figure>



<ul>
<li>So we like 14 variables, namely</li>
</ul>

<!--listend-->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">coefficients</span>(modelFit,id<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>) <span style="color:#f92672">%&gt;%</span> print</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##   (Intercept)    PrivateYes          Apps        Accept        Enroll
## -1.817040e+03  2.256946e+03 -2.999022e-01  8.023519e-01 -5.372545e-01
##     Top10perc   F.Undergrad    Room.Board      Personal           PhD
##  2.365529e+01 -9.569936e-02  8.741819e-01 -2.478418e-01  1.269506e+01
##      Terminal     S.F.Ratio   perc.alumni        Expend     Grad.Rate
##  2.297296e+01 -4.700560e+01  4.195006e+01  2.003912e-01  2.383197e+01</code></pre></div>
<ul>
<li>But five seems like a better bet.</li>
</ul>

<!--listend-->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">coefficients</span>(modelFit,id<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>)</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##   (Intercept)    PrivateYes    Room.Board           PhD   perc.alumni
## -2864.6325619  2936.7416766     1.0677573    40.5334088    61.3147684
##        Expend
##     0.2253945</code></pre></div>
<h4 id="b-gam">b) GAM</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">library</span>(gam)</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">fit <span style="color:#f92672">=</span> <span style="color:#a6e22e">gam</span>(Outstate <span style="color:#f92672">~</span> Private<span style="color:#f92672">+</span><span style="color:#a6e22e">s</span>(Apps,<span style="color:#ae81ff">3</span>)<span style="color:#f92672">+</span>Accept<span style="color:#f92672">+</span>Enroll<span style="color:#f92672">+</span>
            Top10perc<span style="color:#f92672">+</span>F.Undergrad<span style="color:#f92672">+</span>Room.Board<span style="color:#f92672">+</span>
            Personal<span style="color:#f92672">+</span>PhD<span style="color:#f92672">+</span>Terminal<span style="color:#f92672">+</span>S.F.Ratio<span style="color:#f92672">+</span>
            perc.alumni<span style="color:#f92672">+</span>Expend<span style="color:#f92672">+</span>Grad.Rate
        , data <span style="color:#f92672">=</span> colDat)</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">fit2 <span style="color:#f92672">=</span> <span style="color:#a6e22e">gam</span>(Outstate <span style="color:#f92672">~</span> Private<span style="color:#f92672">+</span><span style="color:#a6e22e">s</span>(Room.Board,<span style="color:#ae81ff">2</span>)<span style="color:#f92672">+</span><span style="color:#a6e22e">s</span>(PhD,<span style="color:#ae81ff">3</span>)<span style="color:#f92672">+</span><span style="color:#a6e22e">s</span>(perc.alumni)<span style="color:#f92672">+</span>Expend
        , data <span style="color:#f92672">=</span> colDat)</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">par</span>(mfrow<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">2</span>))
<span style="color:#a6e22e">plot</span>(fit,se<span style="color:#f92672">=</span><span style="color:#66d9ef">TRUE</span>)</code></pre></div>
<p><img src="https://rgoswami.me/islr/sol5/unnamed-chunk-39-1.png" alt="" />
<img src="https://rgoswami.me/islr/sol5/unnamed-chunk-39-2.png" alt="" />
<img src="https://rgoswami.me/islr/sol5/unnamed-chunk-39-3.png" alt="" />
<img src="https://rgoswami.me/islr/sol5/unnamed-chunk-39-4.png" alt="" /></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">par</span>(mfrow<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">2</span>))
<span style="color:#a6e22e">plot</span>(fit2,se<span style="color:#f92672">=</span><span style="color:#66d9ef">TRUE</span>)</code></pre></div>

    <figure class="left" >
        <img src="https://rgoswami.me/islr/sol5/unnamed-chunk-40-2.png"   />

        
    </figure>



<h4 id="c-evaluate">c) Evaluate</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">pred <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">predict</span>(fit, test_set)
mse.error <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">mean</span>((test_set<span style="color:#f92672">$</span>Outstate <span style="color:#f92672">-</span> pred)^2)
mse.error <span style="color:#f92672">%&gt;%</span> print</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## [1] 3691891</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">gam.tss <span style="color:#f92672">=</span> <span style="color:#a6e22e">mean</span>((test_set<span style="color:#f92672">$</span>Outstate <span style="color:#f92672">-</span> <span style="color:#a6e22e">mean</span>(test_set<span style="color:#f92672">$</span>Outstate))^2)
test.rss <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> mse.error<span style="color:#f92672">/</span>gam.tss
test.rss <span style="color:#f92672">%&gt;%</span> print</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## [1] 0.7731239</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">pred2 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">predict</span>(fit2, test_set)
mse.error2 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">mean</span>((test_set<span style="color:#f92672">$</span>Outstate <span style="color:#f92672">-</span> pred2)^2)
mse.error2 <span style="color:#f92672">%&gt;%</span> print</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## [1] 4121902</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">gam.tss2 <span style="color:#f92672">=</span> <span style="color:#a6e22e">mean</span>((test_set<span style="color:#f92672">$</span>Outstate <span style="color:#f92672">-</span> <span style="color:#a6e22e">mean</span>(test_set<span style="color:#f92672">$</span>Outstate))^2)
test.rss2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> mse.error2<span style="color:#f92672">/</span>gam.tss2
test.rss2 <span style="color:#f92672">%&gt;%</span> print</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">## [1] 0.7466987</code></pre></div>
<p>This is pretty good model, all told.</p>

<h4 id="d-summary">d) Summary</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">summary</span>(fit) <span style="color:#f92672">%&gt;%</span> print</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##
## Call: gam(formula = Outstate ~ Private + s(Apps, 3) + Accept + Enroll +
##     Top10perc + F.Undergrad + Room.Board + Personal + PhD + Terminal +
##     S.F.Ratio + perc.alumni + Expend + Grad.Rate, data = colDat)
## Deviance Residuals:
##       Min        1Q    Median        3Q       Max
## -6641.083 -1262.806    -5.698  1270.911  9965.901
##
## (Dispersion Parameter for gaussian family taken to be 3749048)
##
##     Null Deviance: 12559297426 on 776 degrees of freedom
## Residual Deviance: 2849276343 on 760 degrees of freedom
## AIC: 13985.3
##
## Number of Local Scoring Iterations: 2
##
## Anova for Parametric Effects
##              Df     Sum Sq    Mean Sq  F value    Pr(&gt;F)
## Private       1 4034912907 4034912907 1076.250 &lt; 2.2e-16 ***
## s(Apps, 3)    1 1344548030 1344548030  358.637 &lt; 2.2e-16 ***
## Accept        1   90544274   90544274   24.151 1.091e-06 ***
## Enroll        1  144471570  144471570   38.535 8.838e-10 ***
## Top10perc     1 1802244831 1802244831  480.721 &lt; 2.2e-16 ***
## F.Undergrad   1   45230645   45230645   12.065 0.0005430 ***
## Room.Board    1 1110285773 1110285773  296.151 &lt; 2.2e-16 ***
## Personal      1   47886988   47886988   12.773 0.0003738 ***
## PhD           1  220249039  220249039   58.748 5.476e-14 ***
## Terminal      1   66366007   66366007   17.702 2.892e-05 ***
## S.F.Ratio     1  190811028  190811028   50.896 2.274e-12 ***
## perc.alumni   1  225293653  225293653   60.094 2.904e-14 ***
## Expend        1  258162295  258162295   68.861 4.805e-16 ***
## Grad.Rate     1   57947219   57947219   15.457 9.214e-05 ***
## Residuals   760 2849276343    3749048
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
##
## Anova for Nonparametric Effects
##             Npar Df Npar F     Pr(F)
## (Intercept)
## Private
## s(Apps, 3)        2  8.571 0.0002085 ***
## Accept
## Enroll
## Top10perc
## F.Undergrad
## Room.Board
## Personal
## PhD
## Terminal
## S.F.Ratio
## perc.alumni
## Expend
## Grad.Rate
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">summary</span>(fit2) <span style="color:#f92672">%&gt;%</span> print</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">##
## Call: gam(formula = Outstate ~ Private + s(Room.Board, 2) + s(PhD,
##     3) + s(perc.alumni) + Expend, data = colDat)
## Deviance Residuals:
##       Min        1Q    Median        3Q       Max
## -8676.030 -1345.678    -8.409  1265.524  9590.459
##
## (Dispersion Parameter for gaussian family taken to be 4175193)
##
##     Null Deviance: 12559297426 on 776 degrees of freedom
## Residual Deviance: 3194023899 on 765.0002 degrees of freedom
## AIC: 14064.05
##
## Number of Local Scoring Iterations: 2
##
## Anova for Parametric Effects
##                   Df     Sum Sq    Mean Sq F value    Pr(&gt;F)
## Private            1 3751107814 3751107814  898.43 &lt; 2.2e-16 ***
## s(Room.Board, 2)   1 2913770756 2913770756  697.88 &lt; 2.2e-16 ***
## s(PhD, 3)          1 1149711330 1149711330  275.37 &lt; 2.2e-16 ***
## s(perc.alumni)     1  556759894  556759894  133.35 &lt; 2.2e-16 ***
## Expend             1  554812125  554812125  132.88 &lt; 2.2e-16 ***
## Residuals        765 3194023899    4175193
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
##
## Anova for Nonparametric Effects
##                  Npar Df Npar F     Pr(F)
## (Intercept)
## Private
## s(Room.Board, 2)       1 4.9853 0.0258517 *
## s(PhD, 3)              2 9.1614 0.0001171 ***
## s(perc.alumni)         3 0.8726 0.4548496
## Expend
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre></div>
            </div>
        </article>

        <hr />

        <div class="post-info">
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://rgoswami.me/tags/solutions">solutions</a></span><span class="tag"><a href="https://rgoswami.me/tags/r">R</a></span><span class="tag"><a href="https://rgoswami.me/tags/islr">ISLR</a></span>
                </p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>5900 Words</p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2020-02-19 09:47 &#43;0000</p>
        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h">Read other posts</span>
                    <hr />
                </div>

                <div class="pagination__buttons">
                    
                        <span class="button previous">
                            <a href="https://rgoswami.me/posts/bojack-horseman/">
                                <span class="button__icon">←</span>
                                <span class="button__text">Bojack Horseman</span>
                            </a>
                        </span>
                    

                    
                        <span class="button next">
                            <a href="https://rgoswami.me/posts/islr-ch6/">
                                <span class="button__text">ISLR :: Linear Model Selection and Regularization</span>
                                <span class="button__icon">→</span>
                            </a>
                        </span>
                    
                </div>
            </div>
        

        
          <div id="comments" class="thin">
    <script src="https://utteranc.es/client.js"
        repo="haozeke/haozeke.github.io"
        issue-term="pathname"
        theme="photon-dark"
        label="Utterance 💬"
        crossorigin="anonymous"
        async>
</script>

</div>
        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
                <span><a href="https://rgoswami.me">Rohit Goswami (HaoZeke)</a></span>
            
            <span></span>
            <span> <a href="https://rgoswami.me/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Based on a theme by <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="https://rgoswami.me/bundle.min.2d5469329143160ae2456a69c3c76dc2d0a3b212b46afe291a51bd68650ed6f8697e001dab54f1c272c77ce08092a8c55e5bb4314e0ee334aab4b927ec896638.js" integrity="sha512-LVRpMpFDFgriRWppw8dtwtCjshK0av4pGlG9aGUO1vhpfgAdq1TxwnLHfOCAkqjFXlu0MU4O4zSqtLkn7IlmOA=="></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-109503488-16', 'auto');
        ga('send', 'pageview');
    </script>



    </body>
</html>
