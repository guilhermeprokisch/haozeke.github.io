<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="[Rohit Goswami]">
<meta name="description" content="Background One of the best things about writing in orgmode is that we can embed and execute arbitrary code snippets. However, not all languages have an exporter, for obvious reasons. Somewhat surprisingly, there is no way to call pandoc on embedded snippets, which feels like a waste, especially when a whole bunch of documentation formats can be converted to orgmode with it.
Consider the following beautifully highlighted snippet of an rst (ReStructured Text) list table." />
<meta name="keywords" content=", tools, emacs, workflow, orgmode" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://rgoswami.me/posts/org-pandoc-babel/" />


<title>
    
    Pandoc to Orgmode with Babel :: Rohit Goswami  ‚Äî Reflections
    
</title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
      type="text/css">



<link rel="stylesheet" href="https://rgoswami.me/main.min.7bfbbe12786fa0ded4b4c0d792cbb36a5bd0bdb0b856dde57aa7b1f6fe0f2b87.css">


<link href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism-twilight.min.css" rel="stylesheet" />




<meta itemprop="name" content="Pandoc to Orgmode with Babel">
<meta itemprop="description" content="Background One of the best things about writing in orgmode is that we can embed and execute arbitrary code snippets. However, not all languages have an exporter, for obvious reasons. Somewhat surprisingly, there is no way to call pandoc on embedded snippets, which feels like a waste, especially when a whole bunch of documentation formats can be converted to orgmode with it.
Consider the following beautifully highlighted snippet of an rst (ReStructured Text) list table.">


<meta itemprop="datePublished" content="2020-05-02T16:39:00&#43;00:00" />
<meta itemprop="dateModified" content="2020-05-10T21:32:24&#43;00:00" />
<meta itemprop="wordCount" content="406">



<meta itemprop="keywords" content="tools,emacs,workflow,orgmode," />
<meta property="og:title" content="Pandoc to Orgmode with Babel" />
<meta property="og:description" content="Background One of the best things about writing in orgmode is that we can embed and execute arbitrary code snippets. However, not all languages have an exporter, for obvious reasons. Somewhat surprisingly, there is no way to call pandoc on embedded snippets, which feels like a waste, especially when a whole bunch of documentation formats can be converted to orgmode with it.
Consider the following beautifully highlighted snippet of an rst (ReStructured Text) list table." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://rgoswami.me/posts/org-pandoc-babel/" />

<meta property="og:image" content="https://rgoswami.me" />
<meta property="article:published_time" content="2020-05-02T16:39:00+00:00" />
<meta property="article:modified_time" content="2020-05-10T21:32:24+00:00" /><meta property="og:site_name" content="Rohit Goswami" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://rgoswami.me"/>

<meta name="twitter:title" content="Pandoc to Orgmode with Babel"/>
<meta name="twitter:description" content="Background One of the best things about writing in orgmode is that we can embed and execute arbitrary code snippets. However, not all languages have an exporter, for obvious reasons. Somewhat surprisingly, there is no way to call pandoc on embedded snippets, which feels like a waste, especially when a whole bunch of documentation formats can be converted to orgmode with it.
Consider the following beautifully highlighted snippet of an rst (ReStructured Text) list table."/>



    <meta property="article:section" content="programming" />



    <meta property="article:published_time" content="2020-05-02 16:39:00 &#43;0000 UTC" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <div class="header__inner">
            <div class="logo">
<a href="https://rgoswami.me/" style="text-decoration: none;">
        
            <img src="https://rgoswami.me/images/home.png" alt="" />
        
</a>
    </div>


        
        <div class="button">
            <div class="button__text">
        <a href="https://rgoswami.me/search" >
                Search
        </a>
            </div>
        </div>
       

        <div class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://rgoswami.me/about">About</a></li><li><a href="https://rgoswami.me/posts">Blog</a></li>
    </ul>
    <ul class="menu__inner"><li><a href="https://rgoswami.me/categories">Categories</a></li><li><a href="https://rgoswami.me/tags">Tags</a></li>
    </ul>
</nav>

                <div class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </div>
            

            <div class="theme-toggle unselectable"><svg class="theme-toggler" width="32" height="32" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</div>
        </div>
    </div>
</header>

            
<script src="https://rgoswami.me/js/mathjax-config.js"></script>


<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-chtml.js"></script>

            <div class="content">
                
    <main class="post">

        <div class="post-info">
            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>2 minutes

            

            </p>
        </div>

        <article>
            <h1 class="post-title">
                <a href="https://rgoswami.me/posts/org-pandoc-babel/">Pandoc to Orgmode with Babel</a>
            </h1>
                <hr />
                <aside id="toc">
                <div class="toc-title">Table of Contents</div>
                    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#background">Background</a></li>
<li><a href="#writing-an-exporter">Writing an Exporter</a></li>
<li><a href="#trying-it-out">Trying it out</a></li>
<li><a href="#conclusions">Conclusions</a></li>
</ul></li>
</ul>
</nav>
                </aside>
                <hr />

            

            <div class="post-content">
                

<h2 id="background">Background</h2>

<p>One of the best things about writing in <code>orgmode</code> is that we can embed and
execute arbitrary code snippets. However, not all languages have an exporter,
for obvious reasons. Somewhat surprisingly, there is no way to call <a href="https://pandoc.org/MANUAL.html" target="_blank">pandoc</a> on embedded snippets, which feels like a waste, especially when a whole bunch of documentation formats can be converted to <code>orgmode</code> with it.</p>

<p>Consider the following beautifully highlighted snippet of an <code>rst</code> (ReStructured Text) <a href="https://sublime-and-sphinx-guide.readthedocs.io/en/latest/tables.html" target="_blank">list table</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rest" data-lang="rest">.. <span style="color:#f92672">list-table</span>:: Title<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>   <span style="color:#a6e22e">:widths:</span> <span style="color:#a6e22e">25 25 50</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>   <span style="color:#a6e22e">:header-rows:</span> <span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>
   <span style="color:#ae81ff">*</span> - Heading row 1, column 1<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>     <span style="color:#ae81ff">-</span> Heading row 1, column 2<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>     <span style="color:#ae81ff">-</span> Heading row 1, column 3<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>   <span style="color:#ae81ff">*</span> - Row 1, column 1<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>     -<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>     - Row 1, column 3<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>   <span style="color:#ae81ff">*</span> - Row 2, column 1<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>     - Row 2, column 2<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>   - Row 2, column 3</code></pre></div>
<p>Trying to run this will generate the sort of obvious error:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">org-babel-execute-src-block: No org-babel-execute function for rst!</code></pre></div>
<h2 id="writing-an-exporter">Writing an Exporter</h2>

<p>For this post, I will be focusing on <code>rst</code>, but this can be defined for any of the <code>pandoc</code> back-ends. The approach was inspired by <a href="https://github.com/hoelterhof/ob-markdown/blob/master/ob-markdown.el" target="_blank">ob-markdown</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(defun org-babel-execute:rst (body params)
  <span style="color:#e6db74">&#34;Execute a block of rst code with org-babel.
</span><span style="color:#e6db74">This function is called by </span><span style="color:#e6db74">`org-babel-execute-src-block&#39;</span><span style="color:#e6db74">.&#34;</span>
  (let* ((result-params (split-string (or (<span style="color:#a6e22e">cdr</span> (<span style="color:#a6e22e">assoc</span> :results params)) <span style="color:#e6db74">&#34;&#34;</span>)))
       (in-file (org-babel-temp-file <span style="color:#e6db74">&#34;rst-&#34;</span>))
       (cmdline (<span style="color:#a6e22e">cdr</span> (<span style="color:#a6e22e">assoc</span> :cmdline params)))
       (to (<span style="color:#a6e22e">cdr</span> (<span style="color:#a6e22e">assoc</span> :to params)))
       (template (<span style="color:#a6e22e">cdr</span> (<span style="color:#a6e22e">assoc</span> :template params)))
       (cmd (<span style="color:#a6e22e">concat</span> <span style="color:#e6db74">&#34;pandoc&#34;</span>
                    <span style="color:#e6db74">&#34; -t  org&#34;</span>
                    <span style="color:#e6db74">&#34; -i &#34;</span> (org-babel-process-file-name in-file)
                    <span style="color:#e6db74">&#34; -f rst &#34;</span>
                    <span style="color:#e6db74">&#34; &#34;</span> cmdline)))
    (with-temp-file in-file (<span style="color:#a6e22e">insert</span> body))
    (<span style="color:#a6e22e">message</span> cmd)
    (shell-command-to-string cmd))) <span style="color:#75715e">;; Send to results</span>

(defun org-babel-prep-session:rst (session params)
  <span style="color:#e6db74">&#34;Return an error because rst does not support sessions.&#34;</span>
  (<span style="color:#a6e22e">error</span> <span style="color:#e6db74">&#34;rst does not support sessions&#34;</span>))</code></pre></div>
<h2 id="trying-it-out">Trying it out</h2>

<p>With that done, it is pretty trivial to re-run the above example.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rest" data-lang="rest">.. <span style="color:#f92672">list-table</span>:: Title<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>   <span style="color:#a6e22e">:widths:</span> <span style="color:#a6e22e">25 25 50</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>   <span style="color:#a6e22e">:header-rows:</span> <span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>
   <span style="color:#ae81ff">*</span> - Heading row 1, column 1<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>     <span style="color:#ae81ff">-</span> Heading row 1, column 2<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>     <span style="color:#ae81ff">-</span> Heading row 1, column 3<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>   <span style="color:#ae81ff">*</span> - Row 1, column 1<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>     -<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>     - Row 1, column 3<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>   <span style="color:#ae81ff">*</span> - Row 2, column 1<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>     - Row 2, column 2<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>   - Row 2, column 3</code></pre></div>
<table>
<thead>
<tr>
<th>Heading row 1, column 1</th>
<th>Heading row 1, column 2</th>
<th>Heading row 1, column 3</th>
</tr>
</thead>

<tbody>
<tr>
<td>Row 1, column 1</td>
<td></td>
<td>Row 1, column 3</td>
</tr>

<tr>
<td>Row 2, column 1</td>
<td>Row 2, column 2</td>
<td></td>
</tr>

<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

<p>Note that we have used <code>rst :exports both :results raw</code> as the header argument.</p>

<h2 id="conclusions">Conclusions</h2>

<p>Will probably follow this up with an actual package, which should handle the entire spectrum of <code>pandoc</code> back-ends.</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://rgoswami.me/tags/tools">tools</a></span><span class="tag"><a href="https://rgoswami.me/tags/emacs">emacs</a></span><span class="tag"><a href="https://rgoswami.me/tags/workflow">workflow</a></span><span class="tag"><a href="https://rgoswami.me/tags/orgmode">orgmode</a></span>
                </p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>406 Words</p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2020-05-02 16:39 &#43;0000</p>
        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h">Read other posts</span>
                    <hr />
                </div>

                <div class="pagination__buttons">
                    
                        <span class="button previous">
                            <a href="https://rgoswami.me/posts/colemak-dots-refactor/">
                                <span class="button__icon">‚Üê</span>
                                <span class="button__text">Refactoring Dotfiles For Colemak</span>
                            </a>
                        </span>
                    

                    
                        <span class="button next">
                            <a href="https://rgoswami.me/posts/org-mathematica/">
                                <span class="button__text">Using Mathematica with Orgmode</span>
                                <span class="button__icon">‚Üí</span>
                            </a>
                        </span>
                    
                </div>
            </div>
        

        
          <div id="comments" class="thin">
    <script src="https://utteranc.es/client.js"
        repo="haozeke/haozeke.github.io"
        issue-term="pathname"
        theme="photon-dark"
        label="Utterance üí¨"
        crossorigin="anonymous"
        async>
</script>

</div>
        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
                <span><a href="https://rgoswami.me">Rohit Goswami (HaoZeke)</a></span>
            
            <span><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>.</span>
            <span> <a href="https://rgoswami.me/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Theme <a href="https://rgoswami.me/posts/rationale/">details here</a></span>
        </div>
    </div>
</footer>

            
        </div>

        



<script src="https://rgoswami.me/bundle.min.582d94d7fb9230fda38dd4c9d5ca8014cab7228a34654fe3c3476fc00178e03398e53906f6f25d759a6e29f36ae005e4ddbed05e05a31f3c3febc33bd0e89c58.js" integrity="sha512-WC2U1/uSMP2jjdTJ1cqAFMq3Ioo0ZU/jw0dvwAF44DOY5TkG9vJddZpuKfNq4AXk3b7QXgWjHzw/68M70OicWA=="></script>
<script data-goatcounter="https://rgoswami.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
<script src="https://cdn.jsdelivr.net/combine/npm/prismjs@1.20.0,npm/prismjs@1.20.0/plugins/autoloader/prism-autoloader.min.js"></script>



    </body>
</html>
